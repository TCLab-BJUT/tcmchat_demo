{
	"head":
	{
		"name":"trustchat_expand_subtype",
		"type":"SUBTYPELIST"
	},
	"record":
	{
		"type":"TRUSTCHAT_EXPAND",
		"elem_no":3,
		"elemlist":
		[
			"EXPAND_INFO=0x01",
			"EXPAND_KEY",
			"EXPAND_SIGN"
		]
	}
}
{
	"head":
	{
		"name":"msg_info",
		"type":"RECORDTYPE"
	},
	"record":
	{
		"type":"TRUSTCHAT_EXPAND",
		"subtype":"EXPAND_INFO",
		"struct_desc":
		{
			"elem_desc":
			[
				{"name":"uuid","type":"UUID"},
				{"name":"sender","type":"STRING","size":32},
				{"name":"receiver","type":"STRING","size":32},
				{"name":"time","type":"INT"},
				{"name":"flags","type":"FLAG","ref_name":"trustchat_MSG_FLAG"}
			]
		},
		"index":
		{
			"flag":"INDEX",
			"elemlist":"uuid"
		}
	}	
}
{
	"head":
	{
		"name":"session_key",
		"type":"RECORDTYPE"
	},
	"record":
	{
		"type":"TRUSTCHAT_EXPAND",
		"subtype":"EXPAND_KEY",
		"struct_desc":
		{
			"elem_desc":
			[
				{"name":"asym_key_uuid","type":"UUID"},
				{"name":"key_size","type":"INT"},
				{"name":"key_data","type":"DEFINE","def":"key_size"}
			]
		},
		"index":
		{
			"flag":"INDEX",
			"elemlist":"asym_key_uuid,key_size,key_data"
		}
	}	
}
{
	"head":
	{
		"name":"sign_data",
		"type":"RECORDTYPE"
	},
	"record":
	{
		"type":"TRUSTCHAT_EXPAND",
		"subtype":"EXPAND_SIGN",
		"struct_desc":
		{
			"elem_desc":
			[
				{"name":"sign_key_uuid","type":"UUID"},
				{"name":"sign_result","type":"INT"},
				{"name":"sign_size","type":"INT"},
				{"name":"sign_data","type":"DEFINE","def":"sign_size"}
			]
		},
		"index":
		{
			"flag":"INDEX",
			"elemlist":"sign_key_uuid,sign_size,sign_data"
		}
	}	
}
