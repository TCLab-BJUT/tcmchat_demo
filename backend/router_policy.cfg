{
	"policy_head":
	{
		"name":"trigger",
       		"type":"DISPATCH",
        	"sender":"connector_proc",
	},
	"MATCH_RULES":
	[
		{
			"op":"AND","area":"RECORD","type":"MESSAGE","subtype":"CONN_SYNI","value":{"server_name":"msg_server"}
		}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"msg_test"}
		]
	}
}
{
	"policy_head":
	{
		"name":"remote_login",
       		"type":"QUERY",
        	"sender":"msg_test",
	},
	"MATCH_RULES":
	[
		{
			"op":"AND","type":"TRUSTCHAT_DEMO","subtype":"LOGIN_INFO"
		}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"CONN","target_name":"msg_client"},
			{"target_type":"LOCAL","target_name":"msg_test"}
		]
	}
}
{
	"policy_head":
	{
		"name":"broadcast",
       		"type":"DELIVER",
        	"sender":"msg_test",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"TRUSTCHAT_DEMO","subtype":"CHAT_MSG"},
		{"op":"AND","area":"EXPAND","type":"TRUSTCHAT_EXPAND","subtype":"EXPAND_INFO","value":{"flags":"NORMAL"}}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"CONN","target_name":"msg_client"}
		]
	}
}
{
	"policy_head":
	{
		"name":"broadcast",
       		"type":"DELIVER",
        	"sender":"msg_test",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"TRUSTCHAT_DEMO","subtype":"CHAT_MSG"},
		{"op":"AND","area":"EXPAND","type":"TRUSTCHAT_EXPAND","subtype":"EXPAND_INFO","value":{"flags":"CRYPT"}}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"key_switch"},
			{"target_type":"LOCAL","target_name":"crypt"},
			{"target_type":"CONN","target_name":"msg_client"}
		]
	}
}
{
	"policy_head":
	{
		"name":"broadcast",
       		"type":"DELIVER",
        	"sender":"connector_proc",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"TRUSTCHAR_DEMO","subtype":"CHAT_MSG"},
		{"op":"AND","area":"EXPAND","type":"TRUSTCHAT_EXPAND","subtype":"EXPAND_INFO","value":{"flags":"NORMAL"}}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"PORT","target_name":"msg_test"}
		]
	}
}
{
	"policy_head":
	{
		"name":"broadcast",
       		"type":"DELIVER",
        	"sender":"connector_proc",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"TRUSTCHAT_DEMO","subtype":"CHAT_MSG"},
		{"op":"AND","area":"EXPAND","type":"TRUSTCHAT_EXPAND","subtype":"EXPAND_INFO","value":{"flags":"CRYPT"}}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"key_switch"},
			{"target_type":"LOCAL","target_name":"crypt"},
			{"target_type":"LOCAL","target_name":"msg_test"}
		]
	}
}
{
	"policy_head":
	{
		"name":"key_encrypt",
       		"type":"DELIVER",
        	"sender":"key_switch",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"VTCM_SCRIPT","subtype":"SCRIPT_CALL"}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"vtcm_auto"},
			{"target_type":"LOCAL","target_name":"key_switch"}
		]
	}
}
{
	"policy_head":
	{
		"name":"vtcm_input",
       		"type":"DELIVER",
        	"sender":"vtcm_auto",
	},
	"MATCH_RULES":
	[
		{"op":"AND","type":"VTCM_UTILS"}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"vtcm_utils"},
			{"target_type":"LOCAL","target_name":"vtcm_auto"}
		]
	}
}
